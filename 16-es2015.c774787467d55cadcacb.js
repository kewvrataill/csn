(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{DVfo:function(t,e,i){"use strict";i.r(e),i.d(e,"BettingModule",(function(){return q}));var s=i("ofXK"),n=i("qv+i"),a=i("tyNb"),c=i("fXoL"),o=i("AytR"),r=i("ds5d"),b=i("itXk"),d=i("xgIS"),l=i("FWDm"),p=i("l7P3");const u="[Betting action]",g=Object(p.n)(u+" Loading betting script",Object(p.s)()),h=Object(p.n)(u+" Loading betting script SUCCESS"),j=Object(p.n)(u+" Loading betting script FAILURE"),O={loadSettings:Object(p.n)(u+" Loading betting settings"),loadSettingsSuccess:Object(p.n)(u+" Loading betting settings SUCCESS",Object(p.s)()),loadSettingsFailure:Object(p.n)(u+" Loading betting settings FAILURE",Object(p.s)()),loadScript:g,loadScriptSuccess:h,loadScriptFailure:j},S=Object(p.p)(new class{constructor(){this.scriptLoaded=null,this.settings=null}},Object(p.r)(O.loadScriptSuccess,t=>Object.assign(Object.assign({},t),{scriptLoaded:!0})),Object(p.r)(O.loadScriptFailure,t=>Object.assign(Object.assign({},t),{scriptLoaded:!1})),Object(p.r)(O.loadSettingsSuccess,(t,{response:e})=>Object.assign(Object.assign({},t),{settings:e})));function f(t,e){return S(t,e)}const v=Object(p.o)("betting"),m={settings:Object(p.q)(v,t=>t.settings),scriptLoaded:Object(p.q)(v,t=>t.scriptLoaded)};var w=i("vkgz"),L=i("pLZG"),k=i("IzEk"),F=i("QHKX");const I=["container"];let y=(()=>{class t{constructor(t,e,i,s,n,a){this.zone=t,this.store=e,this.location=i,this.lang=s,this.window=n,this.navigate=a,this.subscribeOnFrameLoadedMessage()}ngAfterViewInit(){this.zone.runOutsideAngular(()=>{Object(b.a)([this.store.select(m.settings),this.store.select(m.scriptLoaded)]).pipe(Object(w.a)(([t,e])=>!e&&this.store.dispatch(O.loadScript({link:o.a.sportsLink}))),Object(L.a)(([t])=>!!t&&!!this.window.BTRenderer),Object(k.a)(1)).subscribe(([t])=>this.createFrame(t))})}ngOnDestroy(){this.bt&&this.bt.kill(),this.sportSubs&&this.sportSubs.unsubscribe()}createFrame(t){this.bt=(new this.window.BTRenderer).initialize({themeName:"pokerdom",brand_id:t.brandId,key:t.key,lang:this.lang,target:this.container.nativeElement,minFrameHeight:700,betslipZIndex:113,onLoad:()=>console.log("loaded"),onInit:()=>console.log("inited"),onRegister:()=>this.navigate(["auth","registration"]),onRecharge:()=>this.navigate(["cashier","deposit"]),onLogin:()=>this.navigate(["auth","login"]),onSessionRefresh:()=>this.window.location.reload(),onRouteChange:t=>this.location.go("/sports?bt-path="+encodeURIComponent(t))})}subscribeOnFrameLoadedMessage(){Object(d.a)(this.window,"message").pipe(Object(L.a)(t=>{var e,i,s;return"spt_message"===t.data.name&&"callback"===(null===(e=t.data.message)||void 0===e?void 0:e.name)&&"onAppLoaded"===(null===(s=null===(i=t.data.message)||void 0===i?void 0:i.payload)||void 0===s?void 0:s.callbackName)}),Object(k.a)(1)).subscribe(()=>this.store.dispatch(F.a.hideLoadingIndicator()))}}return t.\u0275fac=function(e){return new(e||t)(c.Mb(c.A),c.Mb(p.h),c.Mb(s.h),c.Mb(r.g),c.Mb(l.c),c.Mb(r.k))},t.\u0275cmp=c.Gb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){var i;1&t&&c.Ac(I,!0,c.l),2&t&&c.tc(i=c.bc())&&(e.container=i.first)},decls:2,vars:0,consts:[["container",""]],template:function(t,e){1&t&&c.Nb(0,"div",null,0)},encapsulation:2,changeDetection:0}),t})();var R=i("ZoBR"),A=i("lJxs");let M=(()=>{class t{constructor(t,e){this.store=t,this.router=e}canActivate(t,e){return Object(b.a)([this.store.select(R.a.isAuth),this.store.select(R.a.info)]).pipe(Object(A.a)(([t,e])=>!t||!!e.sports||this.router.createUrlTree(["/poker"])))}}return t.\u0275fac=function(e){return new(e||t)(c.Wb(p.h),c.Wb(a.f))},t.\u0275prov=c.Ib({token:t,factory:t.\u0275fac}),t})();const W=[{path:"",component:y,canActivate:[M]}];let B=(()=>{class t{}return t.\u0275mod=c.Kb({type:t}),t.\u0275inj=c.Jb({factory:function(e){return new(e||t)},imports:[[a.i.forChild(W)],a.i]}),t})();var C=i("z6cu"),T=i("JIr8"),_=i("cwPg"),E=i("kQpV");let J=(()=>{class t{constructor(t,e,i){this.http=t,this.tokensService=e,this.transferService=i}loadSettings(){return this.transferService.transferRequest("betting.settings",this.http.get("/api/2/spt_iframe_url/"+(this.tokensService.accessToken?"?token="+this.tokensService.accessToken:"")).pipe(Object(A.a)(t=>_.a.success(t)),Object(A.a)(t=>t._item),Object(T.a)(t=>Object(C.a)(_.a.error(t)))))}}return t.\u0275fac=function(e){return new(e||t)(c.Wb(r.f),c.Wb(r.u),c.Wb(E.a))},t.\u0275prov=c.Ib({token:t,factory:t.\u0275fac}),t})();var $=i("9jGm"),z=i("eIep"),N=i("aGrj"),U=i("LRne"),D=i("lvx5");let G=(()=>{class t{constructor(t,e,i){this.bettingService=t,this.scriptLoader=e,this.actions$=i,this.loadBettingScript$=Object($.c)(()=>this.actions$.pipe(Object($.d)(O.loadScript),Object(z.a)(({link:t})=>this.scriptLoader.loadScript(t).pipe(Object(A.a)(()=>O.loadScriptSuccess()),Object(T.a)(()=>Object(U.a)(O.loadScriptFailure())))))),this.loadBettingSettings$=Object($.c)(()=>this.actions$.pipe(Object($.d)(O.loadScriptSuccess,O.loadSettings),Object(N.a)(this.bettingService.loadSettings().pipe(Object(A.a)(t=>O.loadSettingsSuccess({response:t})),Object(T.a)(t=>Object(U.a)(O.loadSettingsFailure({response:t}))))))),this.bettingNotifications$=Object($.c)(()=>this.actions$.pipe(Object($.d)(O.loadScriptFailure,O.loadSettingsFailure),Object(w.a)(()=>D.a.error({message:"BETTING_SCRIPT_LOAD_FAIL"}))))}}return t.\u0275fac=function(e){return new(e||t)(c.Wb(J),c.Wb(n.b),c.Wb($.a))},t.\u0275prov=c.Ib({token:t,factory:t.\u0275fac}),t})(),K=(()=>{class t{static forRoot(){return{ngModule:t,providers:[J]}}}return t.\u0275mod=c.Kb({type:t}),t.\u0275inj=c.Jb({factory:function(e){return new(e||t)},imports:[[p.j.forFeature("betting",f),$.b.forFeature([G])],p.j,$.b]}),t})(),q=(()=>{class t{}return t.\u0275mod=c.Kb({type:t}),t.\u0275inj=c.Jb({factory:function(e){return new(e||t)},providers:[M],imports:[[s.c,B,K.forRoot(),n.a]]}),t})()}}]);